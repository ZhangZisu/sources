
NOIP2018 模拟赛
NOIP2018 Training
第二试
时间：2018 年 7 月 28 日 08:30 ∼ 12:00
题目名称 主席树 决斗 钦点
题目类型 传统型 传统型 传统型
目录 chairmantree duel appoint
可执行文件名 chairmantree duel appoint
输入文件名 chairmantree.in duel.in appoint.in
输出文件名 chairmantree.outduel.out appoint.out
每个测试点时限 1.0 秒 1.0 秒 3.0 秒
内存限制 512 MB 512 MB 512 MB
测试点数目 25 10 25
每个测试点分值 4 10 4
提交源程序文件名
对于 C++ 语言 chairmantree.cppduel.cpp appoint.cpp
对于 C 语言 chairmantree.c duel.c appoint.c
对于 Pascal 语言 chairmantree.pasduel.pas appoint.pas
编译选项
对于 C++ 语言 -O2 -O2 -O2
对于 C 语言 -O2 -O2 -O2
对于 Pascal 语言 -O2 -O2 -O2

NOIP2018 模拟赛 第二试 主席树（chairmantree）
主席树（chairmantree）
【题目背景】
wangyurzee7 和 Yazid 是好朋友。
【题目描述】
Yazid 和 wangyurzee7 都有喜欢的数，Yazid 非常喜欢 k，wangyurzee7 非常喜欢 l。
现在，他们有一个长度为 n 的序列 A（下标从 1 开始）。这个序列一共会有 n(n+1)
2
个子区间。对于所有长度小于 k 的子区间，Yazid 将会忽略它们；对于所有长度大于等
于 k 的子区间，Yazid 将会选取其中的第 k 小· 元素，将这个元素加入序列 B。
显然地，序列 B 中会有 (n−k+2)(n−k+1)
2 个元素。而这些元素的顺序你并不需要关心，
因为 wangyurzee7 只关心这个数组中的第 l 大· 元素。
wangyurzee7 太弱了，他想请你帮他解决这个问题。
【输入格式】
从文件 chairmantree.in 中读入数据。
第一行 3 个正整数 n, k, l，意义见题目描述。
第二行 n 个用空格隔开的正整数 A1, . . . , An，描述序列 A。
【输出格式】
输出到文件 chairmantree.out 中。
输出一行一个整数表示答案。
【样例 1 输入】
5 2 6
1 2 3 2 4
【样例 1 输出】
2
【样例 2】
见选手目录下的 chairmantree/chairmantree2.in 与 chairmantree/chairmantree2.ans。
第 2 页 共 7 页

NOIP2018 模拟赛 第二试 主席树（chairmantree）
【样例 3】
见选手目录下的 chairmantree/chairmantree3.in 与 chairmantree/chairmantree3.ans。
【提示】
请仔细阅读题目名字。
【子任务】
测试点编号 n 其他约定
1 − 3 100
4 − 7 500
8 − 10 2000
11 − 13
5000
14 − 16 保证 l = 1
17 − 19
20 100000 保证 Ai ≤ 10
21 − 25
对于所有数据，保证 1 ≤ k ≤ n，保证 1 ≤ l ≤
(n−k+2)(n−k+1)
2 ，保证 Ai ≤ 108。
第 3 页 共 7 页

### 决斗（duel）
#### 【题目背景】
小 B 喜欢玩 dota2。
#### 【题目描述】
小 B 非常喜欢玩一个叫做军团指挥官的英雄，这个英雄的大招叫做决斗。军团指挥官可以要求与一名敌方英雄进行决斗。决斗开始后他们会被强迫攻击对方，期间不能使用任何技能和物品。获胜者将永久增加若干攻击力，如果决斗结束时没有人死亡则无任何影响。

小 B 非常喜欢这个技能，于是他去找大 C 进行线下决斗。

他们的决斗是回合制的。初始时，他们分别有若干的 HP（血量）。每个人的攻击力用一个区间 [l,r] 描述，这代表该玩家攻击时，会对对方造成这个区间内某个整数的伤害值，且造成每种伤害值的概率相等。

当一位玩家的 HP 降至 0 或 0 以下，则该玩家阵亡，另一位玩家取得胜利。

小 B 和大 C 轮流攻击，由于大 C 看不起小 B，所以他让小 B 先攻击。

现在，吃瓜群众小 D 知道双方的初始 HP，以及他们的攻击力区间。他对谁能取得胜利很感兴趣。凡事无绝对，大 C 虽然厉害，但是竞技体育的魅力就在于无限的可能。所以小 D请你帮忙计算小 B 创造奇迹（战胜大 C）的概率。
#### 【输入格式】
从文件 `duel.in` 中读入数据。

本题包含多组数据，第一行一个整数 T ，表示数据组数。接下来依次描述每组数据，对于每组数据：

输入一行 6 个用空格隔开的整数 n, yl, yr, m, sl, sr，分别表示小 B 的血量、小 B 的攻击区间左端点、小 B 的攻击区间右端点、大 C 的血量、大 C 的攻击区间左端点、大C 的攻击区间右端点。
#### 【输出格式】
输出到文件 `duel.out` 中。

对于每组数据，输出一行一个十进制实数表示答案，四舍五入保留恰好三位小数。

数据保证若答案为 A，则 `[A − 10^−5, A + 10^−5]` 范围内任意实数四舍五入到第三位小数后均相等。（这意味着精度误差将不会对你造成困扰）

#### 【样例 1 输入】
```
4
1 1 1 500 1 1
1 1 7 7 1 1
23 3 3 66 6 6
50 1 17 60 7 17
```
#### 【样例 1 输出】
```
0.000
0.143
0.000
0.076
```
#### 【子任务】
对于 20% 的数据，保证 T ≤ 10，n, m ≤ 7。

对于 50% 的数据，保证 n, m ≤ 60。

对于另外 10% 的数据，保证小 B 和大 C 的实力和现实一致，即 yl = yr = n = 1，m = 500。

对于另外 10% 的数据，保证 yl = yr，sl = sr。

对于 100% 的数据，保证 1 ≤ n, m ≤ 500。

对于 100% 的数据，保证 T ≤ 400，1 ≤ yl ≤ yr ≤ m，1 ≤ sl ≤ sr ≤ n。


### 钦点（appoint）
#### 【问题描述】
kblack 有一张 n 个节点的图，每个节点有一个点权。但让 kblack 感到生气的是，这张图上并没有任何的边，于是他决定钦点一些边。kblack 喜欢 gcd 和合数，所以 kblack 的钦点规则与 gcd（最大公约数）和合数有关。具体来说，对于 2 个点，如果它们点权的 gcd 为合数，那么 kblack 就会钦点它们之间连一条边。Lucas Skipper 看到了 kblack 幼稚的行为，决定把他批判一番。他知道 kblack 热衷于连通块，因此他会删掉图中的一个点来使得剩余图中最大的连通块最小。即将参加 NOIP 的你对这个问题很感兴趣，于是你想知道，在 Lucas 操作之后，图中剩余的最大连通块的大小是多少。
#### 【输入格式】
从文件 appoint.in 中读入数据。
本题有多组数据。第一行一个整数 T 表示数据组数。接下来依次描述各组数据，对于每组数据：

第一行 1 个正整数 n，表示节点的个数。

第二行 n 个用空格隔开的正整数，依次描述了 1 号节点到 n 号节点的点权 `a1...an`。
#### 【输出格式】
输出到文件 `appoint.out` 中。
对于每组数据，输出一行一个整数，表示答案。
#### 【样例 1 输入】
```
3
5
8 4 12 18 9
5
36 20 84 45 231
7
100 200 300 400 500 600 700
```
#### 【样例 1 输出】
```
2
3
6
```
#### 【样例 2】
见选手目录下的 `appoint/appoint2.in` 与 `appoint/appoint2.ans`。
#### 【子任务】
对于 16% 的数据，保证 n ≤ 300，其中 8% 的数据保证 ai ≤ 2, 000。

对于 40% 的数据，保证 n ≤ 2, 000，其中 20% 的数据保证 ai ≤ 30, 000。

对于 100% 的数据，保证 n ≤ 105，ai ≤ 107，其中 52% 的数据保证 ai ≤ 105。

对于 100% 的数据，保证 T ≤ 10，n ≥ 2，ai ≥ 2。